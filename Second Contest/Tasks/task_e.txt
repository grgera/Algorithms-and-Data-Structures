E. Ricked out

Рик решил на день почувствовать себя бизнесменом!
В городе есть несколько обменников валюты. В рамках данной задачи считаем, что каждый 
обменник специализируется только на двух валютах и может производить операции только 
с ними. Возможно, существуют обменники, специализирующиеся на одинаковых парах валют. 
В каждом обменнике — свой обменный курс: курс обмена A на B — это количество единиц 
валюты B, выдаваемое за 1 единицу валюты A. Также в каждом обменнике есть 
комиссия — сумма, которую вы должны заплатить, чтобы производить операцию. Комиссия 
взимается в той валюте, которую меняет клиент.
Например, если вы хотите поменять 100 долларов США на русские рубли в обменнике, где 
курс обмена равен 29.75, а комиссия равна 0.39, вы получите (100 - 0.39) ⋅ 
29.75 = 2963.3975 рублей (эх, были времена).
Рик обладает некоторой суммой в валюте S. Он задаётся вопросом, можно ли, после нескольких 
операций обмена увеличить свой капитал. Конечно, он хочет, чтобы в конце его деньги вновь 
были в валюте S. Помогите ему ответить на его вопрос. Рик должен всегда должен иметь 
неотрицательную сумму денег.

Формат ввода
Первая строка содержит четыре числа: N — количество валют, M — количество обменников, 
S — валюта, которой располагает Рик, и V — количество единиц этой валюты. Следующие M 
строк содержат по 6 чисел, которые задают описание соответствующих обменников в описанном 
выше формате. Числа разделяются одним или несколькими пробелами. В каждом обменнике курсы 
обмена и комиссии — вещественные числа, задаваемые с точностью не выше двух знаков после 
запятой в десятичном представлении.
Назовём последовательность операций обмена простой, если каждый обменник используется в ней 
не более одного раза. Вы можете считать, что отношение итоговой суммы Рика к исходной не 
будет превосходить 10^4 при любой простой последовательности операций.

Формат вывода
Если Рик может увеличить свой капитал, выведите YES, иначе выведите NO.

Пример
Ввод:  3 2 1 10.0
       1 2 1.0 1.0 1.0 1.0
       2 3 1.1 1.0 1.1 1.0
Вывод: NO